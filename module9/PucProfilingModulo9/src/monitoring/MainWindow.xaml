<Window x:Class="PerformanceMonitor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
        Title="ðŸ” Performance Monitor - Real-time Tracing" 
        Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header / Control Panel -->
        <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸŽ¯ Processo Alvo:" 
                               Foreground="White" 
                               FontSize="14" 
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"/>
                    
                    <ComboBox x:Name="ProcessComboBox" 
                              Width="350" 
                              Height="32"
                              IsEditable="True"
                              SelectionChanged="ProcessComboBox_SelectionChanged"/>
                    
                    <Button Content="ðŸ”„ Atualizar" 
                            Style="{StaticResource PrimaryButton}"
                            Margin="10,0,0,0"
                            Click="RefreshProcesses_Click"/>
                    
                    <Button x:Name="StartButton" 
                            Content="â–¶ï¸ Iniciar Monitoramento" 
                            Style="{StaticResource SuccessButton}"
                            Margin="20,0,0,0"
                            Click="StartMonitoring_Click"/>
                    
                    <Button x:Name="StopButton" 
                            Content="â¹ï¸ Parar" 
                            Style="{StaticResource DangerButton}"
                            Margin="10,0,0,0"
                            IsEnabled="False"
                            Click="StopMonitoring_Click"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock x:Name="StatusText" 
                               Text="â¸ï¸ Aguardando seleÃ§Ã£o de processo..." 
                               Foreground="#888888" 
                               FontSize="12" 
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content Area -->
        <Grid Grid.Row="1" Margin="16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left: Main Charts -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- CPU Chart -->
                <Border Grid.Row="0" Background="{StaticResource CardBrush}" CornerRadius="8" Margin="0,0,8,8" Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="ðŸ“Š CPU" Foreground="White" FontSize="16" FontWeight="Bold"/>
                            <TextBlock x:Name="CpuCurrentText" Text=" 0%" Foreground="#2196F3" FontSize="16" FontWeight="Bold" Margin="10,0,0,0"/>
                            <TextBlock Text=" | UI:" Foreground="#888" FontSize="14" Margin="15,0,0,0"/>
                            <TextBlock x:Name="UiThreadCpuText" Text="0%" Foreground="#FF9800" FontSize="14" FontWeight="Bold" Margin="5,0,0,0"/>
                            <Border x:Name="CpuAlertBadge" 
                                    Background="{StaticResource DangerBrush}" 
                                    CornerRadius="4" 
                                    Padding="8,2" 
                                    Margin="20,0,0,0"
                                    Visibility="Collapsed">
                                <TextBlock Text="âš ï¸ ALERTA!" Foreground="White" FontSize="12"/>
                            </Border>
                        </StackPanel>
                        
                        <lvc:CartesianChart Grid.Row="1" 
                                            x:Name="CpuChart"
                                            TooltipPosition="Top"/>
                    </Grid>
                </Border>
                
                <!-- Memory Chart -->
                <Border Grid.Row="1" Background="{StaticResource CardBrush}" CornerRadius="8" Margin="0,8,8,0" Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="ðŸ’¾ Memory (MB)" Foreground="White" FontSize="16" FontWeight="Bold"/>
                            <TextBlock x:Name="MemoryCurrentText" Text=" 0 MB" Foreground="#4CAF50" FontSize="16" FontWeight="Bold" Margin="10,0,0,0"/>
                            <Border x:Name="MemoryAlertBadge" 
                                    Background="{StaticResource WarningBrush}" 
                                    CornerRadius="4" 
                                    Padding="8,2" 
                                    Margin="20,0,0,0"
                                    Visibility="Collapsed">
                                <TextBlock Text="âš ï¸ ALERTA!" Foreground="White" FontSize="12"/>
                            </Border>
                        </StackPanel>
                        
                        <lvc:CartesianChart Grid.Row="1" 
                                            x:Name="MemoryChart"
                                            TooltipPosition="Top"/>
                    </Grid>
                </Border>
            </Grid>
            
            <!-- Middle: Advanced Metrics -->
            <Grid Grid.Column="1" Margin="8,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Responsiveness Panel -->
                <Border Grid.Row="0" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="âš¡ Responsividade" Foreground="White" FontSize="13" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Status:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="ResponsivenessStatusText" Text="â“ Aguardando" Foreground="White" Margin="8,1" FontSize="11" FontWeight="Bold"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="LatÃªncia:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ResponseTimeText" Text="- ms" Foreground="#4CAF50" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="MÃ©dia:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" x:Name="AvgResponseTimeText" Text="- ms" Foreground="White" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Freezes:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" x:Name="FreezeCountText" Text="0" Foreground="#F44336" Margin="8,1" FontSize="11"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- GC Panel -->
                <Border Grid.Row="1" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ—‘ï¸ Garbage Collection" Foreground="White" FontSize="13" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Gen 0:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="GcGen0Text" Text="0" Foreground="#4CAF50" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Gen 1:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="GcGen1Text" Text="0" Foreground="#FF9800" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Gen 2:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                <TextBlock x:Name="GcGen2Text" Text="0" Foreground="#F44336" Margin="8,1" FontSize="11" FontWeight="Bold"/>
                                <Border x:Name="GcGen2AlertBadge" Background="{StaticResource DangerBrush}" CornerRadius="3" Padding="4,1" Margin="8,0,0,0" Visibility="Collapsed">
                                    <TextBlock Text="âš ï¸" Foreground="White" FontSize="9"/>
                                </Border>
                            </StackPanel>
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Heap:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" x:Name="GcHeapText" Text="- MB" Foreground="White" Margin="8,1" FontSize="11"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- Lock Contention Panel -->
                <Border Grid.Row="2" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ”’ Lock Contention" Foreground="White" FontSize="13" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/><RowDefinition/><RowDefinition/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Rate/sec:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                                <TextBlock x:Name="ContentionRateText" Text="0" Foreground="White" Margin="8,1" FontSize="11"/>
                                <Border x:Name="ContentionAlertBadge" Background="{StaticResource WarningBrush}" CornerRadius="3" Padding="4,1" Margin="8,0,0,0" Visibility="Collapsed">
                                    <TextBlock Text="âš ï¸" Foreground="White" FontSize="9"/>
                                </Border>
                            </StackPanel>
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Total:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ContentionTotalText" Text="0" Foreground="White" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Exceptions:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" x:Name="ExceptionsText" Text="0/sec" Foreground="#F44336" Margin="8,1" FontSize="11"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- UI Thread Chart -->
                <Border Grid.Row="3" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="12">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Text="ðŸ“ˆ UI Thread &amp; Contention" Foreground="White" FontSize="13" FontWeight="Bold" Margin="0,0,0,8"/>
                        <lvc:CartesianChart Grid.Row="1" x:Name="UiThreadChart" TooltipPosition="Top"/>
                    </Grid>
                </Border>
            </Grid>
            
            <!-- Right: Stats & Alerts Panel -->
            <Grid Grid.Column="2" Margin="8,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Process Info -->
                <Border Grid.Row="0" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ“‹ Processo" Foreground="White" FontSize="13" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="PID:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="PidText" Text="-" Foreground="White" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Nome:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ProcessNameText" Text="-" Foreground="White" Margin="8,1" FontSize="11" TextTrimming="CharacterEllipsis"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Threads:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" x:Name="ThreadCountText" Text="-" Foreground="White" Margin="8,1" FontSize="11"/>
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Handles:" Foreground="#888" Margin="0,1" FontSize="11"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" x:Name="HandleCountText" Text="-" Foreground="White" Margin="8,1" FontSize="11"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- Alert Thresholds -->
                <Border Grid.Row="1" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="12" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="âš™ï¸ Alertas" Foreground="White" FontSize="13" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="CPU >" Foreground="#888" VerticalAlignment="Center" FontSize="11"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="CpuThresholdBox" Text="80" Background="#3C3C3C" Foreground="White" BorderThickness="1" BorderBrush="#555" Padding="2" FontSize="11"/>
                            <TextBlock Grid.Row="0" Grid.Column="2" Text=" %" Foreground="#888" VerticalAlignment="Center" FontSize="11"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="MemÃ³ria >" Foreground="#888" VerticalAlignment="Center" FontSize="11" Margin="0,4,0,0"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="MemoryThresholdBox" Text="500" Background="#3C3C3C" Foreground="White" BorderThickness="1" BorderBrush="#555" Padding="2" FontSize="11" Margin="0,4,0,0"/>
                            <TextBlock Grid.Row="1" Grid.Column="2" Text=" MB" Foreground="#888" VerticalAlignment="Center" FontSize="11" Margin="0,4,0,0"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="GC Gen2 >" Foreground="#888" VerticalAlignment="Center" FontSize="11" Margin="0,4,0,0"/>
                            <TextBox Grid.Row="2" Grid.Column="1" x:Name="GcGen2ThresholdBox" Text="5" Background="#3C3C3C" Foreground="White" BorderThickness="1" BorderBrush="#555" Padding="2" FontSize="11" Margin="0,4,0,0"/>
                            <TextBlock Grid.Row="2" Grid.Column="2" Text=" /min" Foreground="#888" VerticalAlignment="Center" FontSize="11" Margin="0,4,0,0"/>
                            
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Contention >" Foreground="#888" VerticalAlignment="Center" FontSize="11" Margin="0,4,0,0"/>
                            <TextBox Grid.Row="3" Grid.Column="1" x:Name="ContentionThresholdBox" Text="10" Background="#3C3C3C" Foreground="White" BorderThickness="1" BorderBrush="#555" Padding="2" FontSize="11" Margin="0,4,0,0"/>
                            <TextBlock Grid.Row="3" Grid.Column="2" Text=" /sec" Foreground="#888" VerticalAlignment="Center" FontSize="11" Margin="0,4,0,0"/>
                        </Grid>
                        <CheckBox x:Name="SoundAlertCheckBox" Content="ðŸ”Š Som" Foreground="White" Margin="0,8,0,0" IsChecked="True" FontSize="11"/>
                    </StackPanel>
                </Border>
                
                <!-- Alert Log -->
                <Border Grid.Row="2" Background="{StaticResource CardBrush}" CornerRadius="8" Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="ðŸš¨ Log de Alertas" Foreground="White" FontSize="14" FontWeight="Bold"/>
                            <Button Content="ðŸ—‘ï¸" 
                                    Background="Transparent" 
                                    Foreground="#888" 
                                    BorderThickness="0" 
                                    Margin="10,0,0,0"
                                    Click="ClearAlerts_Click"
                                    ToolTip="Limpar alertas"/>
                        </StackPanel>
                        
                        <ListBox Grid.Row="1" 
                                 x:Name="AlertLogList" 
                                 Background="Transparent" 
                                 BorderThickness="0"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="#444" BorderThickness="0,0,0,1" Padding="4">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Time}" Foreground="#666" FontSize="10"/>
                                            <TextBlock Text="{Binding Message}" Foreground="{Binding Color}" FontSize="12" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
        
        <!-- Footer / Statistics -->
        <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="ðŸ“ˆ CPU MÃ©dio: " Foreground="#888" FontSize="11"/>
                    <TextBlock x:Name="CpuAvgText" Text="0%" Foreground="#2196F3" FontSize="11"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="ðŸ“ˆ CPU MÃ¡x: " Foreground="#888" FontSize="11"/>
                    <TextBlock x:Name="CpuMaxText" Text="0%" Foreground="#F44336" FontSize="11"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="ðŸ’¾ Mem MÃ©dia: " Foreground="#888" FontSize="11"/>
                    <TextBlock x:Name="MemAvgText" Text="0 MB" Foreground="#4CAF50" FontSize="11"/>
                </StackPanel>
                
                <StackPanel Grid.Column="3" Orientation="Horizontal">
                    <TextBlock Text="ðŸ’¾ Mem MÃ¡x: " Foreground="#888" FontSize="11"/>
                    <TextBlock x:Name="MemMaxText" Text="0 MB" Foreground="#FF9800" FontSize="11"/>
                </StackPanel>
                
                <StackPanel Grid.Column="4" Orientation="Horizontal">
                    <TextBlock Text="ðŸ—‘ï¸ GC2 Total: " Foreground="#888" FontSize="11"/>
                    <TextBlock x:Name="GcGen2TotalText" Text="0" Foreground="#F44336" FontSize="11"/>
                </StackPanel>
                
                <StackPanel Grid.Column="5" Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock Text="â±ï¸ " Foreground="#888" FontSize="11"/>
                    <TextBlock x:Name="ElapsedTimeText" Text="00:00:00" Foreground="White" FontSize="11"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
